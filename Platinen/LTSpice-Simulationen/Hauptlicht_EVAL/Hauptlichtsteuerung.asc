Version 4
SHEET 1 2276 2660
WIRE -400 32 -640 32
WIRE -304 32 -400 32
WIRE -192 32 -304 32
WIRE -144 32 -192 32
WIRE 16 32 -48 32
WIRE 80 32 16 32
WIRE 144 32 80 32
WIRE 288 32 224 32
WIRE 384 32 288 32
WIRE 416 32 384 32
WIRE 528 32 496 32
WIRE 608 32 528 32
WIRE 624 32 608 32
WIRE -304 48 -304 32
WIRE 944 48 912 48
WIRE 976 48 944 48
WIRE 80 64 80 32
WIRE 288 64 288 32
WIRE 976 80 976 48
WIRE 384 96 384 32
WIRE 528 96 528 32
WIRE -400 112 -400 32
WIRE 384 144 384 96
WIRE 528 144 528 96
WIRE -304 160 -304 128
WIRE 80 160 80 128
WIRE 288 160 288 128
WIRE -192 176 -192 32
WIRE 976 192 976 160
WIRE -400 256 -400 176
WIRE -304 256 -304 240
WIRE -304 256 -400 256
WIRE -240 256 -304 256
WIRE -304 272 -304 256
WIRE -640 288 -640 32
WIRE -304 384 -304 352
WIRE -288 384 -304 384
WIRE -192 384 -192 272
WIRE -192 384 -224 384
WIRE -128 384 -128 80
WIRE -128 384 -192 384
WIRE -304 416 -304 384
WIRE -464 496 -496 496
WIRE -352 496 -464 496
WIRE -304 528 -304 512
WIRE -208 528 -304 528
WIRE -304 544 -304 528
WIRE -208 560 -208 528
WIRE -640 640 -640 368
WIRE -304 640 -304 624
WIRE -304 640 -640 640
WIRE -256 640 -304 640
WIRE -208 640 -208 624
WIRE -208 640 -256 640
WIRE -256 672 -256 640
WIRE -64 784 -496 784
WIRE 400 784 -64 784
WIRE 832 784 400 784
WIRE 1008 784 832 784
WIRE 1296 784 1008 784
WIRE 1360 784 1296 784
WIRE 1472 784 1360 784
WIRE 1360 816 1360 784
WIRE 1472 848 1472 784
WIRE 288 864 256 864
WIRE 448 864 368 864
WIRE 400 928 400 784
WIRE 1360 928 1360 896
WIRE 448 944 448 864
WIRE 448 944 432 944
WIRE 496 944 448 944
WIRE 672 944 576 944
WIRE 720 944 672 944
WIRE 192 960 176 960
WIRE 256 960 256 864
WIRE 256 960 192 960
WIRE 368 960 256 960
WIRE 448 976 432 976
WIRE 496 976 448 976
WIRE 672 976 576 976
WIRE 720 976 672 976
WIRE 1472 976 1472 912
WIRE 1472 976 1424 976
WIRE -176 1008 -208 1008
WIRE -16 1008 -96 1008
WIRE 448 1008 448 976
WIRE 400 1024 400 992
WIRE 832 1024 832 784
WIRE 1040 1024 896 1024
WIRE 1296 1024 1296 784
WIRE 1296 1024 1264 1024
WIRE 1472 1024 1472 976
WIRE -64 1072 -64 784
WIRE -16 1088 -16 1008
WIRE -16 1088 -32 1088
WIRE 32 1088 -16 1088
WIRE 176 1088 176 960
WIRE 176 1088 112 1088
WIRE 1040 1088 976 1088
WIRE 1360 1088 1360 1024
WIRE 1360 1088 1264 1088
WIRE -208 1104 -208 1008
WIRE -208 1104 -272 1104
WIRE -96 1104 -208 1104
WIRE 448 1104 448 1088
WIRE -272 1120 -272 1104
WIRE -16 1120 -32 1120
WIRE 32 1120 -16 1120
WIRE 176 1120 112 1120
WIRE -16 1152 -16 1120
WIRE 1040 1152 928 1152
WIRE 1360 1152 1360 1088
WIRE 1360 1152 1264 1152
WIRE -64 1168 -64 1136
WIRE 928 1184 928 1152
WIRE -496 1200 -496 784
WIRE 1360 1200 1360 1152
WIRE 1600 1200 1360 1200
WIRE 1664 1200 1600 1200
WIRE -384 1216 -464 1216
WIRE -320 1216 -384 1216
WIRE 176 1216 176 1120
WIRE 240 1216 176 1216
WIRE 272 1216 240 1216
WIRE 400 1216 352 1216
WIRE 1008 1216 1008 784
WIRE 1040 1216 1008 1216
WIRE 1312 1216 1264 1216
WIRE -624 1232 -672 1232
WIRE -528 1232 -624 1232
WIRE -400 1248 -464 1248
WIRE -272 1248 -272 1200
WIRE -272 1248 -400 1248
WIRE -16 1248 -16 1232
WIRE 240 1264 240 1216
WIRE 400 1264 400 1216
WIRE 976 1264 976 1088
WIRE 1360 1264 1360 1200
WIRE 1360 1264 976 1264
WIRE 928 1280 928 1248
WIRE 1312 1280 1312 1216
WIRE 1312 1280 928 1280
WIRE -496 1296 -496 1264
WIRE -272 1296 -272 1248
WIRE 928 1296 928 1280
WIRE 1360 1296 1360 1264
WIRE 240 1360 240 1328
WIRE 400 1360 400 1344
WIRE 400 1360 240 1360
WIRE 400 1376 400 1360
WIRE 832 1392 832 1104
WIRE 896 1392 896 1024
WIRE 896 1392 832 1392
WIRE 928 1392 928 1360
WIRE 928 1392 896 1392
WIRE 1152 1392 928 1392
WIRE 1360 1392 1360 1360
WIRE 1360 1392 1152 1392
WIRE 1472 1392 1472 1104
WIRE 1472 1392 1360 1392
WIRE -272 1408 -272 1376
WIRE 1152 1424 1152 1392
FLAG -256 672 0
FLAG 80 160 0
FLAG 288 160 0
FLAG -464 496 PWM-MOSFET
FLAG 16 32 MOSFET-OUT
FLAG -384 1216 SÄGEZAHN
FLAG -496 1296 0
FLAG 400 1024 0
FLAG 448 1104 0
FLAG -624 1232 PWM-MOSFET
FLAG 608 32 OUT
FLAG 976 192 0
FLAG 944 48 OUT
FLAG 384 96 SENSA
FLAG 528 96 SENSB
FLAG 672 976 SENSA
FLAG 672 944 SENSB
FLAG 1152 1424 0
FLAG 1600 1200 SÄGEZAHN
FLAG -64 1168 0
FLAG -16 1248 0
FLAG -272 1408 0
FLAG 192 960 U_SENS
FLAG 176 1216 U_REF
FLAG -400 1248 U_COMP
FLAG 400 1376 0
SYMBOL nmos -352 416 R0
SYMATTR InstName M1
SYMATTR Value 2N7000
SYMATTR Prefix X
SYMBOL nmos -240 176 R0
SYMATTR InstName M2
SYMATTR Value 2N7000
SYMATTR Prefix X
SYMBOL res -320 528 R0
SYMATTR InstName R2
SYMATTR Value 200
SYMBOL cap -224 560 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL schottky -224 368 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -320 256 R0
SYMATTR InstName R3
SYMATTR Value 2k
SYMBOL res -320 144 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL ind -320 32 R0
SYMATTR InstName L1
SYMATTR Value 1m
SYMBOL schottky -384 176 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL pmos -48 80 M270
SYMATTR InstName M3
SYMATTR Value BUZ-272
SYMATTR Prefix X
SYMBOL voltage -640 272 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 48V
SYMBOL ind 240 16 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L2
SYMATTR Value 30m
SYMBOL cap 272 64 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL schottky 96 128 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 960 64 R0
SYMATTR InstName R_LAST
SYMATTR Value 5
SYMBOL res 400 16 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_SENS
SYMATTR Value 100m
SYMBOL Opamps\\opamp2 -496 1168 M0
SYMATTR InstName U4
SYMATTR Value LMV321
SYMBOL res 384 848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 592 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -16 10 VTop 2
SYMATTR InstName R9
SYMATTR Value 16k
SYMBOL res 592 960 R90
WINDOW 0 63 54 VBottom 2
WINDOW 3 23 8 VTop 2
SYMATTR InstName R10
SYMATTR Value 16k
SYMBOL res 432 992 R0
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL voltage 832 1008 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 5V
SYMBOL Misc\\NE555 1152 1120 R0
SYMATTR InstName U1
SYMBOL cap 912 1296 R0
SYMATTR InstName C3
SYMATTR Value 47p
SYMBOL cap 1344 1296 R0
SYMATTR InstName C4
SYMATTR Value 4n7
SYMBOL diode 912 1184 R0
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL res 1344 800 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 1456 1008 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL diode 1456 848 R0
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL pnp 1424 1024 R180
SYMATTR InstName Q1
SYMATTR Value BC557B
SYMBOL Opamps\\opamp2 -64 1040 M0
SYMATTR InstName U2
SYMATTR Value LMV321
SYMBOL res -80 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 33k
SYMBOL res 128 1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -16 10 VTop 2
SYMATTR InstName R13
SYMATTR Value 33k
SYMBOL res 128 1104 R90
WINDOW 0 63 54 VBottom 2
WINDOW 3 23 8 VTop 2
SYMATTR InstName R14
SYMATTR Value 33k
SYMBOL res -32 1136 R0
SYMATTR InstName R15
SYMATTR Value 33k
SYMBOL res -288 1104 R0
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL res -288 1280 R0
SYMATTR InstName R17
SYMATTR Value 90k
SYMBOL Opamps\\LTC2054 400 960 M0
SYMATTR InstName U5
SYMBOL voltage 400 1248 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName PCA
SYMATTR Value PULSE(0 5 0 14n 1.5n {d/F} {1/F})
SYMBOL res 368 1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 5k1
SYMBOL cap 224 1264 R0
SYMATTR InstName C5
SYMATTR Value 220n
TEXT -960 56 Left 2 !.tran 30m
TEXT -960 88 Left 2 !.inc BUZ.lib
TEXT -960 120 Left 2 !.inc 2n7000.lib
TEXT -960 200 Left 2 !.param F=100k d=0.5
TEXT 792 736 Left 4 ;Sägezahngenerator 0V bis 3.3V (Ampl. frequenzabhängig!)
TEXT 440 824 Left 2 ;Stromsensor
TEXT -152 1304 Left 2 ;Subtrahierer
TEXT -584 1352 Left 2 ;PWM-Generator
TEXT 256 632 Left 2 ;8A max\n-> 8A*0,1R = 0,8V\n-> 5V max PCA-IN => 5V/0,8V = 6,25 Verstärkung\n-> R8=R11=100k und R9=R10=16k
TEXT -960 152 Left 2 !.inc LMV321.lib
TEXT 96 1488 Left 2 ;LMV321 als Quad-Package erhältlich -> LMV324
TEXT 1544 1336 Left 2 ;C4 = \n330p -> 80kHz\n10n -> 2,5kHz\n1n -> 27kHz
TEXT -512 1480 Left 2 ;Stromsensor Ausgang 0 - 5V\nPCA 0 - 5V\nDiffernzverstärker 0 - 5V\nSpannungsteiler R16/R17 reduziert auf Amplitude des Sägezahns\n    --> mit Poti anpassbar!
